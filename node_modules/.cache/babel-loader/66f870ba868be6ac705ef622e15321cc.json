{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n/**\n * Gets the canonical location for the current page, if set, or returns window.location.\n *\n * @returns {object} window.location-like object.\n */\n\nvar findCanonicalLocation = function findCanonicalLocation() {\n  // eslint-disable-next-line no-undef\n  var _window = window,\n      document = _window.document,\n      location = _window.location;\n  var cLink = document.querySelector('link[rel=\"canonical\"][href]');\n\n  if (cLink) {\n    var link = document.createElement('a');\n    link.href = cLink.href;\n    return link;\n  }\n\n  return location;\n};\n/**\n * Gets the external referrer. Returns null if the referrer is from the same hostname.\n *\n * @param {string} hostname Current hostname\n * @returns {string} Referrer. Empty-string if no referrer is found, or the referrer is internal.\n */\n\n\nvar getReferrer = function getReferrer(hostname) {\n  // eslint-disable-next-line no-undef\n  var _window2 = window,\n      document = _window2.document;\n\n  if (document.referrer.indexOf(hostname) < 0) {\n    return document.referrer;\n  }\n\n  return '';\n};\n/**\n * Gets the user's timezone.\n *\n * @returns {string} The user's timezone.\n */\n\n\nvar getTz = function getTz() {\n  return (// eslint-disable-next-line no-undef\n    window.Intl.DateTimeFormat().resolvedOptions().timeZone\n  );\n};\n/**\n * Encodes the data for the request.\n *\n * @param {object} data Data to encode.\n * @returns {string} Encoded data.\n */\n\n\nvar encodeData = function encodeData(data) {\n  return (// eslint-disable-next-line prefer-template\n    '?' + Object.keys(data).map(function (i) {\n      return \"\".concat(encodeURIComponent(i), \"=\").concat(encodeURIComponent(data[i]));\n    }).join('&')\n  );\n};\n/**\n * Creates a function which takes an event name and event data, and sends it to Fathom.\n *\n * @param {string} trackerUrl Fathom tracker base URL.\n * @param {string} siteId Fathom site ID.\n * @returns {Function} Function taking eventName and data, and sending the result to Fathom.\n */\n\n\nvar sendPayloadFactory = function sendPayloadFactory(trackerUrl, siteId) {\n  return function (eventName, data) {\n    // Verify we're not rendering in the server\n    if (typeof window === 'undefined') return; // eslint-disable-next-line no-undef\n\n    var _window3 = window,\n        navigator = _window3.navigator,\n        document = _window3.document; // Verify we should be sending events for this user\n\n    if (/bot|google|baidu|bing|msn|duckduckbot|teoma|slurp|yandex/i.test(navigator.userAgent)) return;\n    if ('visibilityState' in document && document.visibilityState === 'prerender') return; // Schedule future event if the document has not loaded (not sure if this is necessary in React but it was in the\n    // original fathom.js library so here it is)\n\n    if (document.body === null) {\n      document.addEventListener('DOMContentLoaded', function () {\n        return sendPayloadFactory(trackerUrl, siteId)(eventName, data);\n      });\n    } // Build the payload\n\n\n    var location = findCanonicalLocation();\n    var hostname = \"\".concat(location.protocol, \"//\").concat(location.hostname);\n    var referrer = getReferrer(hostname);\n    var postdata = {\n      p: data.path || location.pathname + location.search,\n      h: data.hostname || hostname,\n      r: data.referrer || referrer,\n      sid: siteId,\n      tz: getTz()\n    }; // Send goal payload, this is in a beacon so it can continue if the page navigates\n\n    if (eventName === 'goal') {\n      postdata.gcode = data.gcode;\n      postdata.gval = data.gval || '0';\n      navigator.sendBeacon(\"\".concat(trackerUrl, \"/\").concat(encodeData(postdata)));\n      return;\n    } // Send other payloads\n\n\n    var element = document.createElement('img');\n    element.setAttribute('alt', '');\n    element.setAttribute('aria-hidden', 'true');\n    element.style.position = 'absolute';\n    element.style.top = '-100px';\n    element.style.left = '-100px';\n    element.src = \"\".concat(trackerUrl, \"/\").concat(encodeData(postdata));\n    element.addEventListener('load', function () {\n      return element.parentNode.removeChild(element);\n    });\n    element.addEventListener('error', function () {\n      return element.parentNode.removeChild(element);\n    });\n    document.body.appendChild(element);\n  };\n};\n\nvar _default = sendPayloadFactory;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/home/aizaz/Desktop/SparkAi/changes/blog1/node_modules/fathom-react/dist/payload.js"],"names":["Object","defineProperty","exports","value","findCanonicalLocation","_window","window","document","location","cLink","querySelector","link","createElement","href","getReferrer","hostname","_window2","referrer","indexOf","getTz","Intl","DateTimeFormat","resolvedOptions","timeZone","encodeData","data","keys","map","i","concat","encodeURIComponent","join","sendPayloadFactory","trackerUrl","siteId","eventName","_window3","navigator","test","userAgent","visibilityState","body","addEventListener","protocol","postdata","p","path","pathname","search","h","r","sid","tz","gcode","gval","sendBeacon","element","setAttribute","style","position","top","left","src","parentNode","removeChild","appendChild","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\n/**\n * Gets the canonical location for the current page, if set, or returns window.location.\n *\n * @returns {object} window.location-like object.\n */\nvar findCanonicalLocation = function findCanonicalLocation() {\n  // eslint-disable-next-line no-undef\n  var _window = window,\n      document = _window.document,\n      location = _window.location;\n  var cLink = document.querySelector('link[rel=\"canonical\"][href]');\n\n  if (cLink) {\n    var link = document.createElement('a');\n    link.href = cLink.href;\n    return link;\n  }\n\n  return location;\n};\n/**\n * Gets the external referrer. Returns null if the referrer is from the same hostname.\n *\n * @param {string} hostname Current hostname\n * @returns {string} Referrer. Empty-string if no referrer is found, or the referrer is internal.\n */\n\n\nvar getReferrer = function getReferrer(hostname) {\n  // eslint-disable-next-line no-undef\n  var _window2 = window,\n      document = _window2.document;\n\n  if (document.referrer.indexOf(hostname) < 0) {\n    return document.referrer;\n  }\n\n  return '';\n};\n/**\n * Gets the user's timezone.\n *\n * @returns {string} The user's timezone.\n */\n\n\nvar getTz = function getTz() {\n  return (// eslint-disable-next-line no-undef\n    window.Intl.DateTimeFormat().resolvedOptions().timeZone\n  );\n};\n/**\n * Encodes the data for the request.\n *\n * @param {object} data Data to encode.\n * @returns {string} Encoded data.\n */\n\n\nvar encodeData = function encodeData(data) {\n  return (// eslint-disable-next-line prefer-template\n    '?' + Object.keys(data).map(function (i) {\n      return \"\".concat(encodeURIComponent(i), \"=\").concat(encodeURIComponent(data[i]));\n    }).join('&')\n  );\n};\n/**\n * Creates a function which takes an event name and event data, and sends it to Fathom.\n *\n * @param {string} trackerUrl Fathom tracker base URL.\n * @param {string} siteId Fathom site ID.\n * @returns {Function} Function taking eventName and data, and sending the result to Fathom.\n */\n\n\nvar sendPayloadFactory = function sendPayloadFactory(trackerUrl, siteId) {\n  return function (eventName, data) {\n    // Verify we're not rendering in the server\n    if (typeof window === 'undefined') return; // eslint-disable-next-line no-undef\n\n    var _window3 = window,\n        navigator = _window3.navigator,\n        document = _window3.document; // Verify we should be sending events for this user\n\n    if (/bot|google|baidu|bing|msn|duckduckbot|teoma|slurp|yandex/i.test(navigator.userAgent)) return;\n    if ('visibilityState' in document && document.visibilityState === 'prerender') return; // Schedule future event if the document has not loaded (not sure if this is necessary in React but it was in the\n    // original fathom.js library so here it is)\n\n    if (document.body === null) {\n      document.addEventListener('DOMContentLoaded', function () {\n        return sendPayloadFactory(trackerUrl, siteId)(eventName, data);\n      });\n    } // Build the payload\n\n\n    var location = findCanonicalLocation();\n    var hostname = \"\".concat(location.protocol, \"//\").concat(location.hostname);\n    var referrer = getReferrer(hostname);\n    var postdata = {\n      p: data.path || location.pathname + location.search,\n      h: data.hostname || hostname,\n      r: data.referrer || referrer,\n      sid: siteId,\n      tz: getTz()\n    }; // Send goal payload, this is in a beacon so it can continue if the page navigates\n\n    if (eventName === 'goal') {\n      postdata.gcode = data.gcode;\n      postdata.gval = data.gval || '0';\n      navigator.sendBeacon(\"\".concat(trackerUrl, \"/\").concat(encodeData(postdata)));\n      return;\n    } // Send other payloads\n\n\n    var element = document.createElement('img');\n    element.setAttribute('alt', '');\n    element.setAttribute('aria-hidden', 'true');\n    element.style.position = 'absolute';\n    element.style.top = '-100px';\n    element.style.left = '-100px';\n    element.src = \"\".concat(trackerUrl, \"/\").concat(encodeData(postdata));\n    element.addEventListener('load', function () {\n      return element.parentNode.removeChild(element);\n    });\n    element.addEventListener('error', function () {\n      return element.parentNode.removeChild(element);\n    });\n    document.body.appendChild(element);\n  };\n};\n\nvar _default = sendPayloadFactory;\nexports[\"default\"] = _default;"]},"metadata":{},"sourceType":"script"}